<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j">
	<body>
		<f:view>
			<ui:composition template="/layout/template.xhtml">
				<ui:define name="body">
					<h:form id="partyForm">
						<s:fragment rendered="#{partyFormController.managed}">
							<h1>
								<h:outputLabel>
									<h:outputText value="Editing: " />
								</h:outputLabel>

							</h1>
						</s:fragment>

						<s:fragment rendered="#{ ! partyFormController.managed}">
							<h1>
								<h:outputLabel>
									<h:outputText value="Adding a New " />
								</h:outputLabel>
								<h:outputText value="Person"
									rendered="#{party.class.simpleName == 'Person'}" />
								<h:outputText value="Organization"
									rendered="#{party.class.simpleName == 'Organization'}" />
							</h1>
						</s:fragment>

						<s:fragment rendered="#{party.class.simpleName == 'Organization'}">
							<s:decorate id="organizationNameDecoration"
								template="/layout/edit.xhtml">
								<ui:define name="label">Name:</ui:define>
								<h:inputText id="organizationName" value="#{party.name}"
									required="true" />
							</s:decorate>
						</s:fragment>

						<s:fragment rendered="#{party.class.simpleName == 'Person'}">
							<s:decorate id="personFirstNameDecoration"
								template="/layout/edit.xhtml">
								<ui:define name="label">First Name:</ui:define>
								<h:inputText id="personFirstName" value="#{party.firstName}"
									required="true" />
							</s:decorate>
							<s:decorate id="personMiddleNameDecoration"
								template="/layout/edit.xhtml">
								<ui:define name="label">Middle Name:</ui:define>
								<h:inputText id="personMiddleName" value="#{party.middleName}" />
							</s:decorate>
							<s:decorate id="personLastNameDecoration"
								template="/layout/edit.xhtml">
								<ui:define name="label">Last Name:</ui:define>
								<h:inputText id="personLastName" value="#{party.lastName}"
									required="true" />
							</s:decorate>
						</s:fragment>

						<rich:tabPanel id="partyFormTabPanel"
							selectedTab="#{partyTabController.currentTab}" rendered="#{ partyFormController.managed}">

							<rich:tab id="contactMechanismsTab" label="Contact Methods">

								<rich:panel>
									<f:facet name="header">Addresses</f:facet>
									<ui:include src="/contactMechanism/address/list.xhtml">
										<ui:param name="edit" value="true" />
									</ui:include>
								</rich:panel>

								<rich:panel>
									<f:facet name="header">Contact Mechanisms</f:facet>
									<ui:include src="/contactMechanism/list.xhtml">
										<ui:param name="edit" value="true" />
									</ui:include>
								</rich:panel>

							</rich:tab>
							
							<rich:tab id="rolesTab" label="Roles">
								<ui:include src="/role/list.xhtml">
									<ui:param name="edit" value="true" />
								</ui:include>
							</rich:tab>

							<rich:tab id="classificationsTab" label="Classifications">
								<ui:include src="/classification/list.xhtml">
									<ui:param name="edit" value="true" />
								</ui:include>
							</rich:tab>

							<rich:tab id="casesTab" label="Cases Involved In"
								rendered="#{s:hasRole('nobody')}">
								<rich:dataTable id="casesListTable"
									value="#{party.caseRolesInvolvedIn}" var="curCaseRole">
									<rich:column id="caseColumn" selfSorted="true">
										<f:facet name="header">Case</f:facet>
										<h:outputText value="#{curCaseRole.roleFor.description}" />
									</rich:column>
									<rich:column id="caseRoleColumn" selfSorted="true">
										<f:facet name="header">Role</f:facet>
										<h:outputText value="#{curCaseRole.describedBy}" />
									</rich:column>
								</rich:dataTable>
							</rich:tab>

							<rich:tab id="communicationEventTab" label="Communication Events"
								rendered="#{s:hasRole('nobody')}">
								<rich:dataTable id="partyCommunicationEventListTable"
									value="#{party.eventRolesInvolvedIn}"
									var="curCommunicationEvent">
									<rich:column id="noteColumn" selfSorted="true">
										<f:facet name="header">Note</f:facet>
										<h:outputText value="#{curCommunicationEvent.of.note}" />
									</rich:column>
									<rich:column id="rolePartyPlayedColumn" selfSorted="true">
										<f:facet name="header">Role</f:facet>
										<h:outputText value="#{curCommunicationEvent.describedBy}" />
									</rich:column>
								</rich:dataTable>
							</rich:tab>

							<rich:tab id="relationshipTab" label="Relationships">
								<ui:repeat value="#{party.actingAs}" var="curRole">
									<ui:include
										src="/relationship/partyRelationshipList.xhtml">
										<ui:param name="role" value="#{curRole}" />
									</ui:include>
								</ui:repeat>
							</rich:tab>

						</rich:tabPanel>

						<ui:include src="/components/homeButtonsComponent.xhtml">
							<ui:param name="home" value="#{partyFormController}" />
						</ui:include>

					</h:form>
				</ui:define>
			</ui:composition>
		</f:view>
	</body>
</html>
