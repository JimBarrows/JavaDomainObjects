<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<body>
	<ui:composition template="/layout/template.xhtml">
		<ui:define name="body">
			<h:form id="partyForm">
				<c:if test="#{partyFormController.managed}">
					<h1>
						<h:outputLabel>
							<h:outputText value="Editing: " />
						</h:outputLabel>
					</h1>
				</c:if>

				<c:if test="#{ ! partyFormController.managed}">
					<h1>
						<h:outputText value="Adding a New " />
						<h:outputText value="Person"
							rendered="#{partyFormController.party.class.simpleName == 'Person'}" />
						<h:outputText value="Organization"
							rendered="#{partyFormController.party.class.simpleName == 'Organization'}" />
					</h1>
				</c:if>

				<c:if
					test="#{partyFormController.party.class.simpleName == 'Organization'}">
					<h:inputText id="organizationName"
						value="#{partyFormController.party.name}" required="true">
						<h:outputLabel value="Name" />
					</h:inputText>
				</c:if>

				<c:if
					test="#{partyFormController.party.class.simpleName == 'Person'}">
					<h:outputLabel value="First Name" for="personFirstName" />
					<h:inputText id="personFirstName"
						value="#{partyFormController.party.firstName}" required="true" />
					<h:outputLabel value="Middle Name" for="personMiddleName" />
					<h:inputText id="personMiddleName"
						value="#{partyFormController.party.middleName}"/>
					<h:outputLabel value="Last Name" for="personLastName" />
					<h:inputText id="personLastName"
						value="#{partyFormController.party.lastName}" required="true"/>
				</c:if>

				<ui:remove>
					<rich:tabPanel id="partyFormTabPanel"
						selectedTab="#{partyTabController.currentTab}"
						rendered="#{ partyFormController.managed}">

						<rich:tab id="contactMechanismsTab" label="Contact Methods">

							<rich:panel>
								<f:facet name="header">Addresses</f:facet>
								<ui:include src="/contactMechanism/address/list.xhtml">
									<ui:param name="edit" value="true" />
								</ui:include>
							</rich:panel>

							<rich:panel>
								<f:facet name="header">Contact Mechanisms</f:facet>
								<ui:include src="/contactMechanism/list.xhtml">
									<ui:param name="edit" value="true" />
								</ui:include>
							</rich:panel>

						</rich:tab>

						<rich:tab id="rolesTab" label="Roles">
							<ui:include src="/role/list.xhtml">
								<ui:param name="edit" value="true" />
							</ui:include>
						</rich:tab>

						<rich:tab id="classificationsTab" label="Classifications">
							<ui:include src="/classification/list.xhtml">
								<ui:param name="edit" value="true" />
							</ui:include>
						</rich:tab>

						<rich:tab id="casesTab" label="Cases Involved In"
							rendered="#{s:hasRole('nobody')}">
							<rich:dataTable id="casesListTable"
								value="#{party.caseRolesInvolvedIn}" var="curCaseRole">
								<rich:column id="caseColumn" selfSorted="true">
									<f:facet name="header">Case</f:facet>
									<h:outputText value="#{curCaseRole.roleFor.description}" />
								</rich:column>
								<rich:column id="caseRoleColumn" selfSorted="true">
									<f:facet name="header">Role</f:facet>
									<h:outputText value="#{curCaseRole.describedBy}" />
								</rich:column>
							</rich:dataTable>
						</rich:tab>

						<rich:tab id="communicationEventTab" label="Communication Events"
							rendered="#{s:hasRole('nobody')}">
							<rich:dataTable id="partyCommunicationEventListTable"
								value="#{party.eventRolesInvolvedIn}"
								var="curCommunicationEvent">
								<rich:column id="noteColumn" selfSorted="true">
									<f:facet name="header">Note</f:facet>
									<h:outputText value="#{curCommunicationEvent.of.note}" />
								</rich:column>
								<rich:column id="rolePartyPlayedColumn" selfSorted="true">
									<f:facet name="header">Role</f:facet>
									<h:outputText value="#{curCommunicationEvent.describedBy}" />
								</rich:column>
							</rich:dataTable>
						</rich:tab>

						<rich:tab id="relationshipTab" label="Relationships">
							<ui:repeat value="#{party.actingAs}" var="curRole">
								<ui:include src="/relationship/partyRelationshipList.xhtml">
									<ui:param name="role" value="#{curRole}" />
								</ui:include>
							</ui:repeat>
						</rich:tab>

					</rich:tabPanel>
				</ui:remove>
				<ui:include src="/components/homeButtons.xhtml">
					<ui:param name="home" value="#{partyFormController}" />
				</ui:include>
			</h:form>
		</ui:define>
	</ui:composition>
</body>
</html>
