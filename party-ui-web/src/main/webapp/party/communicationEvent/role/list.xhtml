<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:p="http://jboss.com/products/seam/pdf">
	<body>
		<ui:component>
			<div class="actionButtons">

				<h:commandButton id="addCommunicationEventRoleButton"
					action="#{communicationEventHome.addCommunicationEventRole}"
					value="Add" rendered="#{edit and ! addEvent}">
					<a:support reRender="communicationEventRoleListTable"
						event="onclick" />
				</h:commandButton>
				<h:commandButton id="addCommunicationEventButton"
					action="/communicationEventForm.xhtml" value="Add"
					rendered="#{edit and addEvent}" />
			</div>
			<rich:dataTable id="communicationEventRoleListTable"
				value="#{communicationEventRoleList}" var="curEventRole">
				<f:facet name="header">Parties Involved</f:facet>
				<rich:column id="communicationEventColumn" sortable="true"
					title="Communication Event" rendered="#{showEvent}">
					<f:facet name="header">Communication Event</f:facet>
					<h:outputText value="#{curEventRole.of.note}"
						rendered="#{not edit}" />
					<s:link id="communicationEventRoleEditLink"
						view="/communicationEventRoleForm.xhtml"
						value="#{curEventRole.of.note}" rendered="#{edit}">
						<f:param name="communicationEvenRoleId" value="#{curEventRole.id}" />
					</s:link>
				</rich:column>
				<rich:column id="descriptionColumn" sortable="true"
					title="Description">
					<f:facet name="header">Role Played</f:facet>
					<h:outputText value="#{curEventRole.describedBy.description}"
						rendered="#{ not edit}" />
					<h:selectOneMenu id="communicationEventRoleType"
						value="#{communicationEventRole.describedBy}" required="true"
						rendered="#{edit}">
						<s:selectItems
							value="#{communicationEventRoleTypeList.resultList}"
							var="curCommunicationEventRole"
							label="#{curCommunicationEventRole.description}"
							noSelectionLabel="Please Select..." />
						<s:convertEntity />
					</h:selectOneMenu>

				</rich:column>
				<rich:column id="partyColumn" sortable="true" title="Party">
					<f:facet name="header">Other Parties Involved</f:facet>
					<ul>
						<ui:repeat value="#{curEventRole.of.involving}" var="otherRole">
							<s:fragment rendered="#{ otherRole ne curEventRole}">
								<li>
									<ui:include src="/components/displayPartyNameComponent.xhtml">
										<ui:param name="showPartyName" value="true" />
										<ui:param name="party" value="#{otherRole.forParty}" />
									</ui:include>
									<h:outputText
										value=" in role #{otherRole.describedBy.description}" />
								</li>
							</s:fragment>
						</ui:repeat>
					</ul>
				</rich:column>
			</rich:dataTable>
		</ui:component>
	</body>
</html>