<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j">
	<body>
		<ui:component>

			<div class="actionButtons">
				<s:button id="addAddressButton"
					action="#{partyHome.addPostalAddress}" value="Add"
					rendered="#{edit}">
					<a:support reRender="addressTable" event="onclick" />
				</s:button>

			</div>
			<rich:dataTable id="addressTable" title="Address List"
				value="#{party.residingAt}" var="curPostalAddress">

				<rich:column sortable="true" title="Comment">
					<f:facet name="header">Comment</f:facet>
					<s:decorate id="commentTextDecoration"
						template="/layout/cellEdit.xhtml" rendered="#{edit}">
						<h:inputText id="commentText" value="#{curPostalAddress.comment}" />
					</s:decorate>
					<h:outputText value="#{curPostalAddress.comment}"
						rendered="#{not edit}" />
				</rich:column>

				<rich:column sortable="true" title="From">
					<f:facet name="header">From</f:facet>
					<s:decorate id="fromDateDateDecoration"
						template="/layout/cellEdit.xhtml" rendered="#{edit}">
						<rich:calendar id="fromDateDate" value="#{curPostalAddress.from}"
							required="true" datePattern="MM/dd/yyyy" enableManualInput="true" />
					</s:decorate>
					<h:outputText value="#{curPostalAddress.from}"
						rendered="#{not edit}">
						<f:convertDateTime pattern="MM/dd/yyyy" />
					</h:outputText>
				</rich:column>

				<rich:column sortable="true" title="Thru">
					<f:facet name="header">Thru</f:facet>
					<s:decorate id="thruDateDateDecoration"
						template="/layout/cellEdit.xhtml" rendered="#{edit}">
						<rich:calendar id="thruDateDate" value="#{curPostalAddress.thru}"
							datePattern="MM/dd/yyyy" enableManualInput="true" />
					</s:decorate>
					<h:outputText value="#{curPostalAddress.thru}"
						rendered="#{not edit}">
						<f:convertDateTime pattern="MM/dd/yyyy" />
					</h:outputText>
				</rich:column>

				<rich:column sortable="true" title="Address">
					<f:facet name="header">Address</f:facet>
					<s:fragment rendered="#{edit}">
						<s:decorate id="address1TextDecoration"
							template="/layout/edit.xhtml">
							<ui:define name="label">Line 1</ui:define>
							<h:inputText id="address1Text"
								value="#{curPostalAddress.locatedAt.address1}" required="true" />
						</s:decorate>						
					</s:fragment>
					<s:fragment rendered="#{not edit}">
						<h:outputText value="#{curPostalAddress.locatedAt.address1}" />
						<h:outputText
							value="&lt;br /&gt;#{curPostalAddress.locatedAt.address2}"
							rendered="#{not empty curPostalAddress.locatedAt.address2}" />
					</s:fragment>
				</rich:column>

				<rich:column sortable="true" title="City">
					<f:facet name="header">City</f:facet>
					<s:decorate id="citySelectOneDecoration"
						template="/layout/cellEdit.xhtml" rendered="#{edit}">
						<h:inputText id="cityText"
							value="#{curPostalAddress.locatedAt.city.name}" required="true" />
					</s:decorate>
					<h:outputText value="#{curPostalAddress.locatedAt.city.name}"
						rendered="#{not edit}" />
				</rich:column>

				<rich:column sortable="true" title="State">
					<f:facet name="header">State</f:facet>
					<s:decorate id="stateSelectOneDecoration"
						template="/layout/cellEdit.xhtml" rendered="#{edit}">
						<h:inputText id="stateText"
							value="#{curPostalAddress.locatedAt.state.name}" required="true" />
					</s:decorate>
					<h:outputText
						value="#{curPostalAddress.locatedAt.state.name}"
						rendered="#{not edit}" />
				</rich:column>

				<rich:column sortable="true" title="Zip Code">
					<f:facet name="header">Zip Code</f:facet>
					<s:decorate id="zipCodeSelectOneDecoration"
						template="/layout/cellEdit.xhtml" rendered="#{edit}">
						<h:inputText id="zipCodeText"
							value="#{curPostalAddress.locatedAt.zipCode.name}" required="true" />
					</s:decorate>
					<s:fragment rendered="#{not edit}">
						<h:outputText value="#{curPostalAddress.locatedAt.zipCode.name}" />
						<h:outputText
							value="  + #{curPostalAddress.locatedAt.zipCode.plus4}"
							rendered="#{not empty curPostalAddress.locatedAt.zipCode.plus4}" />
					</s:fragment>
				</rich:column>

			</rich:dataTable>
			<h:outputText rendered="#{empty party.residingAt}">There are no addresses.</h:outputText>
		</ui:component>
	</body>
</html>